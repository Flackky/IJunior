using System;
using System.Collections.Generic;

namespace Sixth_part
{
    internal class Program
    {
        static void Main(string[] args)
        {
            const string AddAction = "1";
            const string BanAction = "2";
            const string UnbanAction = "3";
            const string DeleteAction = "4";
            const string ExitAction = "5";

            const string AddMessage = AddAction + " - Добавить игрока\n";
            const string BanMessage = BanAction + " - Заблокировать игрока\n";
            const string UnbanMessage = UnbanAction + " - Разблокировать игрока\n";
            const string DeleteMessage = DeleteAction + " - Удалить игрока\n";
            const string ExitMessage = ExitAction + " - выход";
            bool canEnter = true;

            string userInput;
            List<Database> playerList = new List<Database>();
            Database database = new Database();

            while (canEnter)
            {
                database.ShowPlayerList(playerList);

                Console.SetCursorPosition(0, 0);
                Console.Write($"Меню:\n{AddMessage}{BanMessage}{UnbanMessage}{DeleteMessage}{ExitMessage}\n-> ");
                userInput = Console.ReadLine();

                switch (userInput)
                {
                    case AddAction:
                        database.AddNewPlayer(playerList);
                        break;
                    case BanAction:
                        database.BanPlayer(playerList);
                        break;
                    case UnbanAction:
                        database.UnbanPlayer(playerList);
                        break;
                    case DeleteAction:
                        database.DeletePlayer(playerList);
                        break;
                    case ExitAction:
                        canEnter = false;
                        break;
                    default:
                        Console.WriteLine("Неизвестная команда.");
                        Console.ReadKey();
                        Console.Clear();
                        break;
                }
            }
        }
    }

    class Player
    {
        public static int Ids {get; protected set;}
        public int Id { get; protected set; }
        public string Name { get; protected set; }
        public int Level { get; protected set; }
        public int HealthPoints { get; protected set; }
        public int ManaPoints { get; protected set; }
        public bool IsBanned { get; protected set; }

        public Player()
        {
            Id = ++Ids;
            Name = "Игрок";
            Level = 1;
            HealthPoints = 100;
            ManaPoints = 10000;
            IsBanned = false;
        }

        public Player(string name, int level)
        {
            Id = Ids++;
            Name = name;
            Level = level;
            HealthPoints = 100;
            ManaPoints = 10000;
            IsBanned = false;
        }

        public void ShowStats()
        {
            Console.Write($"ID игрока - {Id}, Имя - {Name}, Уровень - {Level}, Очки здоровья - {HealthPoints}, Очки маны - {ManaPoints}, ");

            if (IsBanned)
                Console.WriteLine("Блокировка - Есть");
            else
                Console.WriteLine("Блокировка - Отсутствует");
        }

        public void SetBannedStatus()
        {
            IsBanned = true;
        }

        public void SetUnbannedStatus()
        {
            IsBanned = false;
        }
    }

    class Database : Player
    {
        public Database(string name, int level) : base (name, level) { }

        public Database() { }

        public void ShowPlayerList(List<Database> playerList)
        {
            Console.SetCursorPosition(0, 20);
            Console.WriteLine("Список игроков:");

            for (int i = 0; i < playerList.Count; i++)
            {
                playerList[i].ShowStats();
            }
        }

        public void AddNewPlayer(List<Database> playerList)
        {
            Random random = new Random();
            int randomMin = 1;
            int randomMax = 101;

            Console.Write("Введите имя игрока: ");
            string name = Console.ReadLine();
            Database player = new Database(name, random.Next(randomMin, randomMax));
            playerList.Add(player);

            Console.WriteLine("Информация о добавленном игроке: ");
            player.ShowStats();
            Console.ReadKey();
            Console.Clear();
        }

        public void GetPlayerId(List<Database> playerList, ref int outputId)
        {
            string idInput = Console.ReadLine();
            int convertedId;

            if (Int32.TryParse(idInput, out convertedId))
            {
                for (int i = 0; i < playerList.Count; i++)
                {
                    if (playerList[i].Id == convertedId)
                    {
                        outputId = i;
                        break;
                    }
                }
            }
        }

        public void BanPlayer(List<Database> playerList)
        {
            int outputId = -1;
            Console.Write("Введите ID игрока, которого необходимо заблокировать: ");
            GetPlayerId(playerList, ref outputId);

            if (outputId == -1)
            {
                Console.Write("Такого ID не существует.");
                Console.ReadKey();
            }
            else
            {
                playerList[outputId].SetBannedStatus();
            }

            Console.Clear();
        }

        public void UnbanPlayer(List<Database> playerList)
        {
            int outputId = -1;
            Console.Write("Введите ID игрока, которого необходимо разлокировать: ");
            GetPlayerId(playerList, ref outputId);

            if (outputId == -1)
            {
                Console.Write("Такого ID не существует.");
                Console.ReadKey();
            }
            else
            {
                playerList[outputId].SetUnbannedStatus();
            }

            Console.Clear();
        }

        public void DeletePlayer(List<Database> playerList)
        {
            int outputId = -1;
            Console.Write("Введите ID игрока, которого необходимо удалить: ");
            GetPlayerId(playerList, ref outputId);

            if (outputId == -1)
            {
                Console.Write("Такого ID не существует.");
                Console.ReadKey();
            }
            else
            {
                playerList.Remove(playerList[outputId]);
            }

            Console.Clear();
        }
    }
}
